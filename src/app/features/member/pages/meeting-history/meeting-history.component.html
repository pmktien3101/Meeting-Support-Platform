<div class="meeting-history-page">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Lá»‹ch Sá»­ Cuá»™c Há»p</h1>
      <p class="page-subtitle">Xem láº¡i cÃ¡c cuá»™c há»p Ä‘Ã£ tham gia vÃ  tÃ¬m kiáº¿m thÃ´ng tin</p>
    </div>
    <div class="header-actions">
      <button type="button" class="btn btn-outline" (click)="refreshHistory()">
        <span class="btn-icon">ğŸ”„</span>
        LÃ m Má»›i
      </button>
      <button type="button" class="btn btn-primary" (click)="exportHistory()">
        <span class="btn-icon">ğŸ“¤</span>
        Xuáº¥t BÃ¡o CÃ¡o
      </button>
    </div>
  </div>

  <!-- Search and Filters -->
  <div class="search-filters-section">
    <div class="search-box">
      <input 
        type="text" 
        placeholder="TÃ¬m kiáº¿m theo tÃªn cuá»™c há»p, dá»± Ã¡n, tá»« khÃ³a..."
        [(ngModel)]="searchTerm"
        (input)="filterMeetings()"
        class="search-input"
      >
      <span class="search-icon">ğŸ”</span>
    </div>
    
    <div class="filter-options">
      <select [(ngModel)]="projectFilter" (change)="filterMeetings()" class="filter-select" title="Dá»± Ã¡n" aria-label="Lá»c theo dá»± Ã¡n">
        <option value="">Táº¥t cáº£ dá»± Ã¡n</option>
        <option *ngFor="let project of projects()" [value]="project">{{ project }}</option>
      </select>
      
      <select [(ngModel)]="dateFilter" (change)="filterMeetings()" class="filter-select" title="Thá»i gian" aria-label="Lá»c theo thá»i gian">
        <option value="">Táº¥t cáº£ thá»i gian</option>
        <option value="today">HÃ´m nay</option>
        <option value="week">Tuáº§n nÃ y</option>
        <option value="month">ThÃ¡ng nÃ y</option>
        <option value="quarter">QuÃ½ nÃ y</option>
        <option value="year">NÄƒm nay</option>
      </select>
    </div>
  </div>

  <!-- Meeting History Grid -->
  <div class="meetings-grid">
    <div *ngFor="let meeting of filteredMeetings()" class="meeting-card">
      <div class="meeting-header">
        <div class="meeting-date">
          <div class="date">{{ meeting.date }}</div>
          <div class="time">{{ meeting.time }}</div>
        </div>
        <div class="meeting-status" [class]="meeting.status">
          {{ getStatusText(meeting.status) }}
        </div>
      </div>
      
      <div class="meeting-content">
        <h3 class="meeting-title">{{ meeting.title }}</h3>
        <p class="meeting-project">{{ meeting.project }}</p>
        <p class="meeting-description">{{ meeting.description }}</p>
        
        <div class="meeting-meta">
          <span class="organizer">ğŸ‘¤ {{ meeting.organizer }}</span>
          <span class="duration">â±ï¸ {{ meeting.duration }}</span>
          <span class="participants">ğŸ‘¥ {{ meeting.participants.length }} ngÆ°á»i</span>
        </div>
      </div>
      
      <div class="meeting-actions">
        <button type="button" class="btn btn-sm btn-outline" (click)="viewTranscript(meeting)">
          <span class="btn-icon">ğŸ“</span>
          Transcript
        </button>
        <button type="button" class="btn btn-sm btn-outline" (click)="viewSummary(meeting)">
          <span class="btn-icon">ğŸ“‹</span>
          Summary
        </button>
        <button type="button" class="btn btn-sm btn-outline" (click)="viewTodoList(meeting)">
          <span class="btn-icon">âœ…</span>
          To-do List
        </button>
        <button type="button" class="btn btn-sm btn-primary" (click)="viewMeetingDetails(meeting)">
          <span class="btn-icon">ğŸ‘ï¸</span>
          Chi Tiáº¿t
        </button>
      </div>
      
      <div class="meeting-tags" *ngIf="meeting.tags.length > 0">
        <span 
          *ngFor="let tag of meeting.tags" 
          class="meeting-tag"
        >
          {{ tag }}
        </span>
      </div>
    </div>
    
    <div *ngIf="filteredMeetings().length === 0" class="empty-state">
      <div class="empty-icon">ğŸ“…</div>
      <h3>KhÃ´ng cÃ³ cuá»™c há»p nÃ o</h3>
      <p>{{ searchTerm || projectFilter || dateFilter ? 'Thá»­ thay Ä‘á»•i bá»™ lá»c Ä‘á»ƒ xem káº¿t quáº£ khÃ¡c' : 'Báº¡n chÆ°a tham gia cuá»™c há»p nÃ o' }}</p>
    </div>
  </div>

  <!-- Quick Actions Panel -->
  <div class="quick-actions-panel">
    <div class="panel-header">
      <h3>Thao TÃ¡c Nhanh</h3>
    </div>
    <div class="panel-content">
      <button type="button" class="quick-action-btn" (click)="viewTodayMeetings()">
        <span class="action-icon">ğŸ“…</span>
        <span class="action-text">Há»p HÃ´m Nay</span>
      </button>
      <button type="button" class="quick-action-btn" (click)="viewRecentMeetings()">
        <span class="action-icon">ğŸ•’</span>
        <span class="action-text">Há»p Gáº§n ÄÃ¢y</span>
      </button>
      <button type="button" class="quick-action-btn" (click)="searchByKeywords()">
        <span class="action-icon">ğŸ”</span>
        <span class="action-text">TÃ¬m Theo Tá»« KhÃ³a</span>
      </button>
      <button type="button" class="quick-action-btn" (click)="viewProjectMeetings()">
        <span class="action-icon">ğŸ“Š</span>
        <span class="action-text">Há»p Theo Dá»± Ãn</span>
      </button>
    </div>
  </div>

  <!-- Modals -->
  <!-- Transcript Modal -->
  <div class="modal-backdrop" *ngIf="isTranscriptOpen" (click)="closeTranscript()"></div>
  <div class="modal modal-lg" *ngIf="isTranscriptOpen" role="dialog" aria-modal="true">
    <div class="modal-header">
      <h3>Transcript - {{ activeMeeting?.title }}</h3>
      <button type="button" class="icon-btn" (click)="closeTranscript()">âœ–</button>
    </div>
    <div class="modal-body">
      <div class="search-box" style="margin-bottom:12px;">
        <input type="text" class="search-input" placeholder="TÃ¬m trong transcript..." [(ngModel)]="transcriptQuery">
      </div>
      <div class="modal-body scrollable">
        <div class="transcript-item" *ngFor="let line of filteredTranscript">
          <div class="speaker">{{ line.speaker }}:</div>
          <div class="speech">{{ line.text }}</div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline" (click)="copyTranscript()" [disabled]="filteredTranscript.length === 0" aria-label="Copy transcript" title="Sao chÃ©p transcript">
        ğŸ“‹ Copy
      </button>
      <button type="button" class="btn btn-primary" (click)="exportTranscript()" [disabled]="filteredTranscript.length === 0" aria-label="Export transcript" title="Táº£i transcript">
        â¬‡ï¸ Export
      </button>
    </div>
  </div>

  <!-- Summary Modal -->
  <div class="modal-backdrop" *ngIf="isSummaryOpen" (click)="closeSummary()"></div>
  <div class="modal modal-md" *ngIf="isSummaryOpen" role="dialog" aria-modal="true">
    <div class="modal-header">
      <h3>TÃ³m táº¯t - {{ activeMeeting?.title }}</h3>
      <button type="button" class="icon-btn" (click)="closeSummary()">âœ–</button>
    </div>
    <div class="modal-body">
      <div class="summary-block" *ngFor="let block of summaryBlocks">
        <div class="summary-title">{{ block.title }}</div>
        <div class="summary-content">{{ block.content }}</div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline" (click)="copySummary()" [disabled]="summaryBlocks.length === 0" aria-label="Copy summary" title="Sao chÃ©p tÃ³m táº¯t">
        ğŸ“‹ Copy
      </button>
      <button type="button" class="btn btn-primary" (click)="exportSummary()" [disabled]="summaryBlocks.length === 0" aria-label="Export summary" title="Táº£i tÃ³m táº¯t">
        â¬‡ï¸ Export
      </button>
    </div>
  </div>

  <!-- Todo Modal -->
  <div class="modal-backdrop" *ngIf="isTodoOpen" (click)="closeTodo()"></div>
  <div class="modal modal-md" *ngIf="isTodoOpen" role="dialog" aria-modal="true">
    <div class="modal-header">
      <h3>To-do - {{ activeMeeting?.title }}</h3>
      <button type="button" class="icon-btn" (click)="closeTodo()">âœ–</button>
    </div>
    <div class="modal-body">
      <div class="todo-item" *ngFor="let item of todoItems">
        <input type="checkbox" [checked]="item.done" (change)="toggleTodoDone(item.id)">
        <div class="todo-content">
          <div class="todo-text" [class.done]="item.done">{{ item.text }}</div>
          <div class="todo-meta">
            <span *ngIf="item.assignee">ğŸ‘¤ {{ item.assignee }}</span>
            <span *ngIf="item.due">â° {{ item.due }}</span>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline" (click)="copyTodos()" [disabled]="todoItems.length === 0" aria-label="Copy todos" title="Sao chÃ©p To-do">
        ğŸ“‹ Copy
      </button>
      <button type="button" class="btn btn-primary" (click)="exportTodos()" [disabled]="todoItems.length === 0" aria-label="Export todos" title="Táº£i To-do">
        â¬‡ï¸ Export
      </button>
    </div>
  </div>

  <!-- Details Modal -->
  <div class="modal-backdrop" *ngIf="isDetailsOpen" (click)="closeDetails()"></div>
  <div class="modal modal-md" *ngIf="isDetailsOpen" role="dialog" aria-modal="true">
    <div class="modal-header">
      <h3>Chi tiáº¿t cuá»™c há»p - {{ activeMeeting?.title }}</h3>
      <button type="button" class="icon-btn" (click)="closeDetails()">âœ–</button>
    </div>
    <div class="modal-body">
      <div class="details-grid">
        <div><strong>NgÃ y:</strong> {{ activeMeeting?.date }}</div>
        <div><strong>Giá»:</strong> {{ activeMeeting?.time }}</div>
        <div><strong>Thá»i lÆ°á»£ng:</strong> {{ activeMeeting?.duration }}</div>
        <div><strong>Tráº¡ng thÃ¡i:</strong> {{ activeMeeting ? getStatusText(activeMeeting.status) : '' }}</div>
        <div><strong>Dá»± Ã¡n:</strong> {{ activeMeeting?.project }}</div>
        <div><strong>NgÆ°á»i tá»• chá»©c:</strong> {{ activeMeeting?.organizer }}</div>
        <div class="participants-list">
          <strong>Tham dá»±:</strong> {{ (activeMeeting?.participants || []).join(', ') }}
        </div>
        <div><strong>MÃ´ táº£:</strong> {{ activeMeeting?.description }}</div>
      </div>  
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline" (click)="closeDetails()">ÄÃ³ng</button>
    </div>
  </div>
</div>