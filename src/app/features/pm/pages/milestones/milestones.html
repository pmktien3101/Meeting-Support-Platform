<div class="milestones-page">
  <div class="page-header">
    <div class="header-content">
      <div class="header-title-section">
        <button *ngIf="isProjectSpecific" class="btn btn-outline btn-sm back-btn" (click)="backToProjects()">
          â† Quay láº¡i Dá»± Ãn
        </button>
        <h2 *ngIf="!isProjectSpecific">ğŸ¯ Quáº£n LÃ½ Milestone</h2>
        <h2 *ngIf="isProjectSpecific">ğŸ¯ Milestones - {{ currentProject?.name }}</h2>
        <p *ngIf="!isProjectSpecific">Theo dÃµi vÃ  quáº£n lÃ½ cÃ¡c milestone cá»§a dá»± Ã¡n</p>
        <p *ngIf="isProjectSpecific">Quáº£n lÃ½ milestones cho dá»± Ã¡n {{ currentProject?.name }}</p>
      </div>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="openCreateMilestone()">
        â• Táº¡o Milestone Má»›i
      </button>
      <button class="btn btn-secondary">
        ğŸ“Š Xem BÃ¡o CÃ¡o
      </button>
    </div>
  </div>

  <!-- Project Info Section (only for project-specific view) -->
  <div *ngIf="isProjectSpecific && currentProject" class="project-info-section">
    <div class="project-info-card">
      <div class="project-info-header">
        <div class="project-icon">ğŸ“</div>
        <div class="project-info">
          <h3>{{ currentProject.name }}</h3>
          <p>{{ currentProject.description }}</p>
        </div>
        <div class="project-status">
          <span class="status-badge" [class]="currentProject.status">
            {{ currentProject.status === 'active' ? 'Äang thá»±c hiá»‡n' : 
               currentProject.status === 'planning' ? 'Láº­p káº¿ hoáº¡ch' : 
               currentProject.status === 'completed' ? 'HoÃ n thÃ nh' : currentProject.status }}
          </span>
        </div>
      </div>
      <div class="project-info-meta">
        <div class="meta-item">
          <span class="meta-icon">ğŸ“…</span>
          <span class="meta-text">
            {{ currentProject.startDate | date:'dd/MM/yyyy' }} - {{ currentProject.endDate | date:'dd/MM/yyyy' }}
          </span>
        </div>
        <div class="meta-item">
          <span class="meta-icon">ğŸ‘¤</span>
          <span class="meta-text">{{ currentProject.manager }}</span>
        </div>
        <div class="meta-item">
          <span class="meta-icon">â°</span>
          <span class="meta-text">Tiáº¿n Ä‘á»™: {{ currentProject.progress }}%</span>
        </div>
      </div>
    </div>

    <!-- Project Members Section -->
    <div class="project-members-section">
      <div class="section-header">
        <h4>ğŸ‘¥ ThÃ nh viÃªn dá»± Ã¡n</h4>
        <span class="member-count">{{ currentProject.members.length }} thÃ nh viÃªn</span>
      </div>
      
      <div class="members-grid">
        <div class="member-card" *ngFor="let member of currentProject.members">
          <div class="member-avatar">{{ member.avatar }}</div>
          <div class="member-info">
            <h5 class="member-name">{{ member.name }}</h5>
            <p class="member-role">{{ member.role }}</p>
            <p class="member-email">{{ member.email }}</p>
          </div>
          <button class="remove-member-btn" 
                  (click)="removeMemberFromProject(currentProject, member.id)"
                  title="XÃ³a thÃ nh viÃªn">
            Ã—
          </button>
        </div>
        
        <!-- Add Member Card -->
        <div class="add-member-card">
          <div class="add-member-content">
            <div class="add-member-icon">+</div>
            <h5>ThÃªm thÃ nh viÃªn</h5>
            <select class="add-member-select" 
                    (change)="onMemberSelect(currentProject, $event)">
              <option value="">Chá»n thÃ nh viÃªn...</option>
              <option *ngFor="let member of getAvailableMembersForProject(currentProject)" 
                      [value]="member.id">
                {{ member.name }} - {{ member.role }}
              </option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="milestones-filters">
    <div class="filter-group">
      <label>Tráº¡ng thÃ¡i:</label>
      <select class="filter-select" aria-label="Lá»c theo tráº¡ng thÃ¡i">
        <option value="">Táº¥t cáº£</option>
        <option value="pending">Chá» thá»±c hiá»‡n</option>
        <option value="in-progress">Äang thá»±c hiá»‡n</option>
        <option value="completed">HoÃ n thÃ nh</option>
        <option value="delayed">Bá»‹ trá»…</option>
      </select>
    </div>
    <div class="filter-group" *ngIf="!isProjectSpecific">
      <label>Dá»± Ã¡n:</label>
      <select class="filter-select" aria-label="Lá»c theo dá»± Ã¡n">
        <option value="">Táº¥t cáº£ dá»± Ã¡n</option>
        <option value="1">Website E-commerce</option>
        <option value="2">Mobile App</option>
        <option value="3">CRM System</option>
      </select>
    </div>
    <div class="filter-group">
      <label>TÃ¬m kiáº¿m:</label>
      <input type="text" class="filter-input" placeholder="TÃ¬m kiáº¿m milestone...">
    </div>
  </div>

  <div class="milestones-grid">
    <div class="milestone-card" *ngFor="let milestone of milestones">
      <div class="milestone-header">
        <div class="milestone-icon">ğŸ¯</div>
        <div class="milestone-status">
          <span class="status-badge" [class]="milestone.status">
            {{ getStatusText(milestone.status) }}
          </span>
        </div>
      </div>
      
      <div class="milestone-content">
        <h3 class="milestone-title">{{ milestone.name }}</h3>
        <p class="milestone-description">{{ milestone.description }}</p>
        
        <div class="milestone-meta">
          <div class="meta-item" *ngIf="!isProjectSpecific">
            <span class="meta-icon">ğŸ“</span>
            <span class="meta-text">{{ milestone.projectName }}</span>
          </div>
          <div class="meta-item">
            <span class="meta-icon">ğŸ“…</span>
            <span class="meta-text">
              {{ milestone.startDate | date:'dd/MM/yyyy' }} - {{ milestone.endDate | date:'dd/MM/yyyy' }}
            </span>
          </div>
          <div class="meta-item">
            <span class="meta-icon">ğŸ‘¥</span>
            <span class="meta-text">5 thÃ nh viÃªn</span>
          </div>
        </div>
        
        <div class="milestone-progress">
          <div class="progress-header">
            <span class="progress-label">Tiáº¿n Ä‘á»™</span>
            <span class="progress-percentage">{{ milestone.progress }}%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="milestone.progress"></div>
          </div>
        </div>
      </div>
      
      <div class="milestone-actions">
        <button class="btn btn-primary btn-sm">Xem Chi Tiáº¿t</button>
        <button class="btn btn-secondary btn-sm">Chá»‰nh Sá»­a</button>
        <button class="btn btn-outline btn-sm">ğŸ“‹ Tasks</button>
      </div>
    </div>
  </div>

  <div class="milestones-summary">
    <div class="summary-card">
      <div class="summary-icon">ğŸ¯</div>
      <div class="summary-content">
        <h4>Tá»•ng sá»‘ milestone</h4>
        <p class="summary-number">{{ milestones.length }}</p>
      </div>
    </div>
    <div class="summary-card">
      <div class="summary-icon">ğŸš€</div>
      <div class="summary-content">
        <h4>Äang thá»±c hiá»‡n</h4>
        <p class="summary-number">{{ getInProgressCount() }}</p>
      </div>
    </div>
    <div class="summary-card">
      <div class="summary-icon">âœ…</div>
      <div class="summary-content">
        <h4>HoÃ n thÃ nh</h4>
        <p class="summary-number">{{ getCompletedCount() }}</p>
      </div>
    </div>
    <div class="summary-card">
      <div class="summary-icon">â°</div>
      <div class="summary-content">
        <h4>Trung bÃ¬nh hoÃ n thÃ nh</h4>
        <p class="summary-number">{{ getAverageProgress() }}%</p>
      </div>
    </div>
  </div>
</div>
