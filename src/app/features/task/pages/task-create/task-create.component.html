<div class="task-create-page">
  <div class="container">
    <!-- Header -->
    <div class="page-header">
      <div class="header-content">
        <h1>Create New Task</h1>
        <p>Add a new task to your project</p>
      </div>
      <div class="header-actions">
        <button class="btn btn-secondary" (click)="cancel()">
          <span class="icon">←</span>
          Back to Tasks
        </button>
      </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage()" class="error-message">
      <span class="icon">⚠️</span>
      {{ errorMessage() }}
    </div>

    <!-- Task Form -->
    <div class="form-container">
      <form (ngSubmit)="createTask()">
        <div class="form-grid">
          <!-- Basic Information -->
          <div class="form-section">
            <h2>Basic Information</h2>
            
            <div class="form-group">
              <label for="title">Task Title *</label>
              <input 
                type="text" 
                id="title"
                name="title"
                [(ngModel)]="taskForm().title"
                placeholder="Enter task title"
                required
                class="form-input"
              >
            </div>

            <div class="form-group">
              <label for="description">Description *</label>
              <textarea 
                id="description"
                name="description"
                [(ngModel)]="taskForm().description"
                placeholder="Describe the task in detail..."
                rows="4"
                required
                class="form-textarea"
              ></textarea>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="priority">Priority</label>
                <select 
                  id="priority"
                  name="priority"
                  [(ngModel)]="taskForm().priority"
                  class="form-select"
                >
                  <option value="low">Low</option>
                  <option value="medium">Medium</option>
                  <option value="high">High</option>
                  <option value="urgent">Urgent</option>
                </select>
              </div>

              <div class="form-group">
                <label for="dueDate">Due Date *</label>
                <input 
                  type="date" 
                  id="dueDate"
                  name="dueDate"
                  [(ngModel)]="taskForm().dueDate"
                  required
                  class="form-input"
                >
              </div>
            </div>
          </div>

          <!-- Assignment -->
          <div class="form-section">
            <h2>Assignment</h2>
            
            <div class="form-group">
              <label for="assignee">Assign To *</label>
              <select 
                id="assignee"
                name="assigneeId"
                [(ngModel)]="taskForm().assigneeId"
                required
                class="form-select"
              >
                <option value="">Select assignee</option>
                <option *ngFor="let user of users" [value]="user.id">
                  {{ user.name }} ({{ user.email }})
                </option>
              </select>
            </div>

            <div class="form-group">
              <label for="project">Project (Optional)</label>
              <select 
                id="project"
                name="projectId"
                [(ngModel)]="taskForm().projectId"
                class="form-select"
              >
                <option value="">No project</option>
                <option *ngFor="let project of projects" [value]="project.id">
                  {{ project.name }}
                </option>
              </select>
            </div>

            <div class="form-group">
              <label for="estimatedHours">Estimated Hours (Optional)</label>
              <input 
                type="number" 
                id="estimatedHours"
                name="estimatedHours"
                [(ngModel)]="taskForm().estimatedHours"
                placeholder="e.g., 8"
                min="0.5"
                step="0.5"
                class="form-input"
              >
            </div>
          </div>
        </div>

        <!-- Tags -->
        <div class="form-section">
          <h2>Tags</h2>
          <p class="section-description">Add tags to help categorize and organize your task</p>
          
          <div class="tags-section">
            <div class="available-tags">
              <h4>Available Tags</h4>
              <div class="tags-grid">
                <button 
                  *ngFor="let tag of availableTags" 
                  type="button"
                  class="tag-btn"
                  [class.selected]="taskForm().tags.includes(tag)"
                  (click)="addTag(tag)"
                >
                  {{ tag }}
                </button>
              </div>
            </div>

            <div class="selected-tags" *ngIf="taskForm().tags.length > 0">
              <h4>Selected Tags</h4>
              <div class="tags-list">
                <span 
                  *ngFor="let tag of taskForm().tags" 
                  class="tag-item"
                >
                  {{ tag }}
                  <button 
                    type="button" 
                    class="remove-tag"
                    (click)="removeTag(tag)"
                    aria-label="Remove tag"
                  >
                    ×
                  </button>
                </span>
              </div>
            </div>

            <div class="custom-tag">
              <h4>Add Custom Tag</h4>
              <div class="custom-tag-input">
                <input 
                  type="text" 
                  placeholder="Enter custom tag"
                  (keyup.enter)="addCustomTag($event)"
                  class="form-input"
                >
                <button 
                  type="button" 
                  class="btn btn-outline"
                  (click)="addCustomTag($event)"
                >
                  Add
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button 
            type="button" 
            class="btn btn-secondary"
            (click)="cancel()"
          >
            Cancel
          </button>
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="isSubmitting()"
          >
            <span *ngIf="isSubmitting()" class="loading-spinner"></span>
            {{ isSubmitting() ? 'Creating...' : 'Create Task' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
