<div class="team-management">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1>Qu·∫£n L√Ω Nh√≥m</h1>
      <p>Qu·∫£n l√Ω th√†nh vi√™n nh√≥m v√† xem th√¥ng tin Project Manager</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="openAddMemberModal()">
        <span class="icon">‚ûï</span>
        Th√™m Th√†nh Vi√™n
      </button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="search-box">
      <input 
        type="text" 
        placeholder="T√¨m ki·∫øm th√†nh vi√™n nh√≥m..." 
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
        class="search-input"
      >
      <span class="search-icon">üîç</span>
    </div>
    
    <div class="filter-controls">
      <select [(ngModel)]="roleFilter" (change)="onRoleFilterChange()" class="filter-select" title="Ch·ªçn vai tr√≤" aria-label="Ch·ªçn vai tr√≤">
        <option value="all">T·∫•t C·∫£ Vai Tr√≤</option>
        <option value="member">Th√†nh Vi√™n</option>
        <option value="project-manager">Project Manager</option>
      </select>
      
      <select [(ngModel)]="statusFilter" (change)="onStatusFilterChange()" class="filter-select" title="Ch·ªçn tr·∫°ng th√°i" aria-label="Ch·ªçn tr·∫°ng th√°i">
        <option value="all">T·∫•t C·∫£ Tr·∫°ng Th√°i</option>
        <option value="active">Ho·∫°t ƒê·ªông</option>
        <option value="inactive">Kh√¥ng Ho·∫°t ƒê·ªông</option>
        <option value="pending">Ch·ªù X·ª≠ L√Ω</option>
      </select>
    </div>
  </div>

  <!-- Team Members List -->
  <div class="team-content">
    <div class="content-header">
      <h2>Th√†nh Vi√™n Nh√≥m ({{ filteredMembers().length }})</h2>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading()" class="loading-state">
      <div class="spinner"></div>
      <p>ƒêang t·∫£i th√†nh vi√™n nh√≥m...</p>
    </div>

    <!-- Team Members Grid -->
    <div *ngIf="!isLoading()" class="team-grid">
      <div *ngFor="let member of filteredMembers()" class="member-card">
        <div class="member-header">
          <div class="member-avatar">
            {{ member.avatar }}
          </div>
          <div class="member-info">
            <h3 class="member-name">{{ member.name }}</h3>
            <p class="member-position">{{ member.position }}</p>
            <div class="member-badges">
              <span class="badge" [class]="getRoleBadgeClass(member.role)">
                {{ member.role === 'project-manager' ? 'PM' : member.role }}
              </span>
              <span class="badge" [class]="getStatusBadgeClass(member.status)">
                {{ member.status }}
              </span>
            </div>
          </div>
        </div>

        <div class="member-details">
          <div class="detail-item">
            <span class="label">Email:</span>
            <span class="value">{{ member.email }}</span>
          </div>
          <div class="detail-item">
            <span class="label">ƒêi·ªán Tho·∫°i:</span>
            <span class="value">{{ member.phone }}</span>
          </div>
          <div class="detail-item">
            <span class="label">Tham Gia:</span>
            <span class="value">{{ member.joinDate | date:'MMM dd, yyyy' }}</span>
          </div>
          <div class="detail-item">
            <span class="label">Ho·∫°t ƒê·ªông Cu·ªëi:</span>
            <span class="value">{{ member.lastActive | date:'MMM dd, yyyy' }}</span>
          </div>
          <div class="detail-item">
            <span class="label">D·ª± √Ån:</span>
            <span class="value">{{ member.projectsCount }}</span>
          </div>
          <div class="detail-item">
            <span class="label">Hi·ªáu Su·∫•t:</span>
            <span class="value" [class]="getPerformanceColor(member.performance)">
              {{ member.performance }}%
            </span>
          </div>
        </div>

        <div class="member-actions">
          <button class="btn btn-outline btn-sm" (click)="openEditMemberModal(member)">
            <span class="icon">‚úèÔ∏è</span>
            S·ª≠a
          </button>
          <button class="btn btn-outline btn-sm">
            <span class="icon">üìß</span>
            Li√™n H·ªá
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading() && filteredMembers().length === 0" class="empty-state">
      <div class="empty-icon">üë•</div>
      <h3>Kh√¥ng t√¨m th·∫•y th√†nh vi√™n nh√≥m</h3>
      <p>H√£y th·ª≠ ƒëi·ªÅu ch·ªânh t√¨m ki·∫øm ho·∫∑c b·ªô l·ªçc ƒë·ªÉ t√¨m th√†nh vi√™n nh√≥m.</p>
    </div>
  </div>
</div>

<!-- Add Member Modal -->
<div class="modal-overlay" *ngIf="shouldShowModal()" (click)="closeAddMemberModal()" (keydown.escape)="closeAddMemberModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Th√™m Th√†nh Vi√™n M·ªõi</h2>
      <button class="modal-close" (click)="closeAddMemberModal()">
        <span class="icon">‚úï</span>
      </button>
      <button class="modal-close emergency-close" (click)="forceCloseModal()" title="ƒê√≥ng kh·∫©n c·∫•p">
        <span class="icon">üö®</span>
      </button>
    </div>
    
    <div class="modal-body">
      <form [formGroup]="addMemberForm" (ngSubmit)="onSubmitAddMember()">
        <div class="form-group">
          <label for="fullName">H·ªç v√† T√™n *</label>
          <input 
            type="text" 
            id="fullName" 
            formControlName="fullName"
            placeholder="Nh·∫≠p h·ªç v√† t√™n ƒë·∫ßy ƒë·ªß"
            class="form-input"
          >
          <div class="error-message" *ngIf="addMemberForm.get('fullName')?.invalid && addMemberForm.get('fullName')?.touched">
            H·ªç v√† t√™n l√† b·∫Øt bu·ªôc
          </div>
        </div>

        <div class="form-group">
          <label for="email">Email *</label>
          <input 
            type="email" 
            id="email" 
            formControlName="email"
            placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ email"
            class="form-input"
          >
          <div class="error-message" *ngIf="addMemberForm.get('email')?.invalid && addMemberForm.get('email')?.touched">
            Email kh√¥ng h·ª£p l·ªá
          </div>
        </div>

        <div class="form-group">
          <label for="phone">S·ªë ƒêi·ªán Tho·∫°i</label>
          <input 
            type="tel" 
            id="phone" 
            formControlName="phone"
            placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"
            class="form-input"
          >
        </div>

        <div class="form-group">
          <label for="position">Ch·ª©c V·ª•</label>
          <input 
            type="text" 
            id="position" 
            formControlName="position"
            placeholder="Nh·∫≠p ch·ª©c v·ª•"
            class="form-input"
          >
        </div>

        <div class="form-group">
          <label>Vai Tr√¥ *</label>
          <div class="role-selection">
            <div class="role-option">
              <input 
                type="checkbox" 
                id="roleMember" 
                [checked]="selectedRoles.member"
                (change)="onRoleChange('member', $event)"
                class="role-checkbox"
              >
              <label for="roleMember" class="role-label">
                <span class="role-icon">üë§</span>
                <span class="role-text">
                  <strong>Member</strong>
                  <small>Th√†nh vi√™n nh√≥m th√¥ng th∆∞·ªùng</small>
                </span>
              </label>
            </div>
            
            <div class="role-option">
              <input 
                type="checkbox" 
                id="rolePM" 
                [checked]="selectedRoles.pm"
                (change)="onRoleChange('pm', $event)"
                class="role-checkbox"
              >
              <label for="rolePM" class="role-label">
                <span class="role-icon">üë®‚Äçüíº</span>
                <span class="role-text">
                  <strong>Project Manager</strong>
                  <small>Qu·∫£n l√Ω d·ª± √°n v√† nh√≥m</small>
                </span>
              </label>
            </div>
          </div>
          <div class="error-message" *ngIf="!selectedRoles.member && !selectedRoles.pm">
            Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt vai tr√≤
          </div>
        </div>

        <div class="form-group">
          <label for="department">Ph√≤ng Ban</label>
          <select id="department" formControlName="department" class="form-select">
            <option value="">Ch·ªçn ph√≤ng ban</option>
            <option value="development">Ph√°t Tri·ªÉn</option>
            <option value="design">Thi·∫øt K·∫ø</option>
            <option value="marketing">Marketing</option>
            <option value="sales">Kinh Doanh</option>
            <option value="hr">Nh√¢n S·ª±</option>
            <option value="finance">T√†i Ch√≠nh</option>
            <option value="other">Kh√°c</option>
          </select>
        </div>

        <div class="form-group">
          <label for="notes">Ghi Ch√∫</label>
          <textarea 
            id="notes" 
            formControlName="notes"
            placeholder="Th√¥ng tin b·ªï sung v·ªÅ th√†nh vi√™n m·ªõi..."
            rows="3"
            class="form-textarea"
          ></textarea>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button class="btn btn-outline" (click)="closeAddMemberModal()">
        H·ªßy
      </button>
      <button 
        class="btn btn-primary" 
        (click)="onSubmitAddMember()"
        [disabled]="addMemberForm.invalid || isSubmitting() || (!selectedRoles.member && !selectedRoles.pm)"
      >
        <span class="icon" *ngIf="!isSubmitting()">‚ûï</span>
        <span class="spinner" *ngIf="isSubmitting()"></span>
        {{ isSubmitting() ? 'ƒêang th√™m...' : 'Th√™m Th√†nh Vi√™n' }}
      </button>
    </div>
  </div>
</div>

<!-- Edit Member Modal -->
<div class="modal-overlay" *ngIf="shouldShowEditModal()" (click)="closeEditMemberModal()" (keydown.escape)="closeEditMemberModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>S·ª≠a Th√¥ng Tin Th√†nh Vi√™n</h2>
      <button class="modal-close" (click)="closeEditMemberModal()">
        <span class="icon">‚úï</span>
      </button>
      <button class="modal-close emergency-close" (click)="forceCloseEditModal()" title="ƒê√≥ng kh·∫©n c·∫•p">
        <span class="icon">üö®</span>
      </button>
    </div>
    
    <div class="modal-body">
      <form [formGroup]="editMemberForm" (ngSubmit)="onSubmitEditMember()">
        <div class="form-group">
          <label for="editFullName">H·ªç v√† T√™n *</label>
          <input 
            type="text" 
            id="editFullName" 
            formControlName="fullName"
            placeholder="Nh·∫≠p h·ªç v√† t√™n ƒë·∫ßy ƒë·ªß"
            class="form-input"
          >
          <div class="error-message" *ngIf="editMemberForm.get('fullName')?.invalid && editMemberForm.get('fullName')?.touched">
            H·ªç v√† t√™n l√† b·∫Øt bu·ªôc
          </div>
        </div>

        <div class="form-group">
          <label for="editEmail">Email *</label>
          <input 
            type="email" 
            id="editEmail" 
            formControlName="email"
            placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ email"
            class="form-input"
          >
          <div class="error-message" *ngIf="editMemberForm.get('email')?.invalid && editMemberForm.get('email')?.touched">
            Email kh√¥ng h·ª£p l·ªá
          </div>
        </div>

        <div class="form-group">
          <label for="editPhone">S·ªë ƒêi·ªán Tho·∫°i</label>
          <input 
            type="tel" 
            id="editPhone" 
            formControlName="phone"
            placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"
            class="form-input"
          >
        </div>

        <div class="form-group">
          <label for="editPosition">Ch·ª©c V·ª•</label>
          <input 
            type="text" 
            id="editPosition" 
            formControlName="position"
            placeholder="Nh·∫≠p ch·ª©c v·ª•"
            class="form-input"
          >
        </div>

        <div class="form-group">
          <label>Vai Tr√≤ *</label>
          <div class="role-selection">
            <div class="role-option">
              <input 
                type="checkbox" 
                id="editRoleMember" 
                [checked]="editSelectedRoles.member"
                (change)="onEditRoleChange('member', $event)"
                class="role-checkbox"
              >
              <label for="editRoleMember" class="role-label">
                <span class="role-icon">üë§</span>
                <span class="role-text">
                  <strong>Member</strong>
                  <small>Th√†nh vi√™n nh√≥m th√¥ng th∆∞·ªùng</small>
                </span>
              </label>
            </div>
            
            <div class="role-option">
              <input 
                type="checkbox" 
                id="editRolePM" 
                [checked]="editSelectedRoles.pm"
                (change)="onEditRoleChange('pm', $event)"
                class="role-checkbox"
              >
              <label for="editRolePM" class="role-label">
                <span class="role-icon">üë®‚Äçüíº</span>
                <span class="role-text">
                  <strong>Project Manager</strong>
                  <small>Qu·∫£n l√Ω d·ª± √°n v√† nh√≥m</small>
                </span>
              </label>
            </div>
          </div>
          <div class="error-message" *ngIf="!editSelectedRoles.member && !editSelectedRoles.pm">
            Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt vai tr√≤
          </div>
        </div>

        <div class="form-group">
          <label for="editStatus">Tr·∫°ng Th√°i</label>
          <select id="editStatus" formControlName="status" class="form-select">
            <option value="active">Ho·∫°t ƒê·ªông</option>
            <option value="inactive">Kh√¥ng Ho·∫°t ƒê·ªông</option>
            <option value="pending">Ch·ªù X·ª≠ L√Ω</option>
          </select>
        </div>

        <div class="form-group">
          <label for="editDepartment">Ph√≤ng Ban</label>
          <select id="editDepartment" formControlName="department" class="form-select">
            <option value="">Ch·ªçn ph√≤ng ban</option>
            <option value="development">Ph√°t Tri·ªÉn</option>
            <option value="design">Thi·∫øt K·∫ø</option>
            <option value="marketing">Marketing</option>
            <option value="sales">Kinh Doanh</option>
            <option value="hr">Nh√¢n S·ª±</option>
            <option value="finance">T√†i Ch√≠nh</option>
            <option value="other">Kh√°c</option>
          </select>
        </div>

        <div class="form-group">
          <label for="editNotes">Ghi Ch√∫</label>
          <textarea 
            id="editNotes" 
            formControlName="notes"
            placeholder="Th√¥ng tin b·ªï sung v·ªÅ th√†nh vi√™n..."
            rows="3"
            class="form-textarea"
          ></textarea>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button class="btn btn-outline" (click)="closeEditMemberModal()">
        H·ªßy
      </button>
      <button 
        class="btn btn-primary" 
        (click)="onSubmitEditMember()"
        [disabled]="editMemberForm.invalid || isEditing() || (!editSelectedRoles.member && !editSelectedRoles.pm)"
      >
        <span class="icon" *ngIf="!isEditing()">üíæ</span>
        <span class="spinner" *ngIf="isEditing()"></span>
        {{ isEditing() ? 'ƒêang l∆∞u...' : 'L∆∞u Thay ƒê·ªïi' }}
      </button>
    </div>
  </div>
</div>


    





